#### 最短路径性质及其证明

阐述最短路径算法正确性的性质，主要分为三个方面，其中所有性质的背景都建立在条件：

- 带权有向图$G=(V,E)$
- 权重函数$w:E\rightarrow R$
- 源节点为`s`
- $\delta(s,v)$表述的是定义源节点到某一节点的最短路径

性质证明之后更多的是利用性质推导定义的最短路径与求解的最短路径的等价关系。

##### 松弛操作与最短路径树

> [引理]图中不含有源节点可达的负权环路，在初始化后进行松弛，前驱子图形成了根节点为源节点的有根树，并且对任意松弛操作后并不改变其结论。

在初始化数据时，前驱子图只包含源节点结论成立；

进行一系列松弛后，假设在前驱子图中创建了环路$p$：
$$
p=<v_0,v_1,...,v_k>
$$
其中$v_0=v_k$，生成环路的过程中假定在$(v_{k-1},v_k)$中生成环路（此处的假设只是架设了其中一个状态且这个成环的状态一定存在）。

那么在未成环的操作期间满足：
$$
v_{i} \cdot d \geq v_{i-1} \cdot d+w\left(v_{i-1}, v_{i}\right) \quad \\ i=1,2, \ldots, k-1 \text {. }
$$
此处的叙述就是说在前$k$个节点之间的松弛判断中不一定进行了改变值的松弛操作，但是最后一个边假设是松弛的值被改变的，所以满足：
$$
v_{k} \cdot d>v_{k-1} \cdot d+w\left(v_{k-1}, v_{k}\right)
$$
则进行不等式的叠加会生成：
$$
\begin{aligned}
\sum_{i=1}^{k} v_{i} \cdot d &>\sum_{i=1}^{k}\left(v_{i-1} \cdot d+w\left(v_{i-1}, v_{i}\right)\right) \\
&=\sum_{i=1}^{k} v_{i-1} \cdot d+\sum_{i=1}^{k} w\left(v_{i-1}, v_{i}\right)
\end{aligned}
$$
因为前期提到的首尾点是相同的（成环），那么进行化简可以得到该环路边权之和为负值，与引理描述前提不符，所以在引理条件下前驱子图中一定不存在环。

现证明图中任何一个前驱子图点集合中的点都存在源节点到其节点的路径：

- 首先做初始化后前驱子图中只有一个源节点满足结论；

- 假设进行$n$次松弛后上述结论成立；

- 进行$n+1$次松弛时，对`v`点的边$(u,v)$进行松弛满足：
  $$
  v . d>u . d+w(u, v)
  $$
  那么在松弛后，`v`点的前驱存在即为`u`，且`u`节点符合假设已经存在一条到源节点的路径（因为是有向边所以更合适的说法是源节点到`u`的路径），那么`v`节点也存在上述假设。

![](C:\Users\SSW\Desktop\111111111111111111111.png)

图中至多包含一条`s`到`v`的简单路径，那么假设有两条路径存在，但是如图可得，`z`节点的前驱只能是一个节点，所以得到两个前驱节点等价的结论，那么其为根节点为`s`的有根树。

证明了前驱子图无环、存在到点集路径、到点集中的节点路径唯一三个大方面证明了前驱子图是一棵有根树。

其中并未证明`s`为根节点，这点可以根据存在到点集路径、到点集中的节点路径唯一得证。

> 前驱子图性质：图中不含源节点可达的负权环路，初始化后进行松弛，该松弛操作将所有的节点属性生成为：
> $$
> v.d=\delta(s,v)
> $$
> 则前驱子图是一棵源节点为`s`的最短路径树。

其中最短路径树定义中有三个性质：

- 节点集合均为源节点可以到达的节点组成的；
- 其拓扑图形成的是以`s`为根节点的树；
- 对于任意其点集合的节点，由源节点出发到其任意节点的一条简单路径就是最短路径。

性质1：因为定义$\delta(s,v)$存在且有限时，则认为`v`点可到达，其中在算法操作中只要被赋予了有限的`.d`属性，则该点的前驱节点都不为空，所以前驱子图中的节点均是源节点可到达的。

性质2：引理得证。

性质3：设前驱子图中存在一条简单路径$p$：
$$
p=<v_0,v_1,...,v_k>
$$
其中首尾各表示`s`源节点与`v`节点，因为有性质：
$$
v_i.d=\delta(s,v_i)
$$
且在前驱子图中满足：
$$
v_{i} \cdot d \geq v_{i-1} \cdot d+w\left(v_{i-1}, v_{i}\right)
$$
将上式移项并代换得到：
$$
w\left(v_{i-1}, v_{i}\right) \leq \delta\left(s, v_{i}\right)-\delta\left(s, v_{i-1}\right)
$$
最终将权重进行求和裂项相消：
$$
\begin{aligned}
w(p) &=\sum_{i=1}^{k} w\left(v_{i-1}, v_{i}\right) \\
& \leq \sum_{i=1}^{k}\left(\delta\left(s, v_{i}\right)-\delta\left(s, v_{i-1}\right)\right) \\
&=\delta\left(s, v_{k}\right)-\delta\left(s, v_{0}\right) \\
&=\delta\left(s, v_{k}\right)
\end{aligned}
$$
最终找到定义最短路值为权值求和后数值的上界，又因为本身定义的最短路径值即为任意一条路径权重的下界，所以得到性质3成立。

最终得证前驱子图形成了一棵源节点为根节点的最短路径树。