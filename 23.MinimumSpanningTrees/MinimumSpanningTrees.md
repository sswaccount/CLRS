#### 最小生成树证明

最小生成树（Minimum Spanning Trees）表示的问题抽象后更多的是在联通无向图$G=(V,E)$中，寻找$|V|-1$条边的集合$T\subseteq E$使得在新图$G^T=(V,T)$为一个联通无向图且边权之和$w(T)=\sum_{(u, v) \in T} w(u, v)$最小。

换句话说就是寻找$|V|-1$条边权之和更小的边集合使得图依旧联通，这时新图的情况比较特殊，会变成一棵树，其树被称为最小生成树。

##### 循环不变式

接下来使用循环不变式证明寻找最小生成树思想的正确性：

<img src="C:\Users\SSW\Desktop\code.png" style="zoom:33%;" />

大体使用贪心的思想，每回合向集合中添加一条边，并遵循性质：

> 每次循环之前，A都作为某棵最小生成树的子集

首先定义安全边为：每回合选择一条边加入集合使其不违反循环不变式，这类边称为安全边。

循环不变式三部描述：

- 初始化：开始之前集合为空集满足条件
- 保持：循环方式加入安全边维持循环不变式性质
- 终止：所有安全边加入集合，A必然是最小生成树

这里指出的安全边和循环不变式三步描述有推卸责任的嫌疑，因为只是言语的描述了维持性质，但类似红黑树在做旋转操作时维护了树的性质，这里的安全边不仅仅作为定义，在后续有相应的操作方法和证明确定它是可以维持循环不变式性质的。

##### 辅助定义

<img src="C:\Users\SSW\Desktop\封面.png" style="zoom:33%;" />

- 切割：在无向图$G=(V,E)$中对点集合进行划分为$S$和$V-S$两部分；
- 横跨：一条边的两个端点分别属于两个切割点集合时称为横跨切割；
- 尊重：集合$A$（或者描述可以说是边集合）在切割的情况影响下不存在横跨切割的边，说明切割尊重集合$A$；
- 轻量级边：横跨切割的所有边中权重最小的边为轻量级边；

##### 证明流程

> 定理：$G=(V,E)$在一条边上定义了加权无向联通图，集合$A$为$E$的子集，$A$包含在$G$的最小生成树中，设$(S,V-S)$为图中尊重集合$A$的切割，$(u,v)$为对应的切割的轻量级边，那么$(u,v)$对于集合$A$是安全的。

<img src="C:\Users\SSW\Desktop\prove.png" style="zoom:33%;" />

设$T$为不含$(u,v)$的最小生成树且包含$A$，如果包含上述轻量级边则证明成立，如果不包含做说明：

在横跨切割中由于$(u,v)$为权值最小的边，那么在$T$中一定存在一个边$(x,y)$且满足$w(u,v)\le w(x,y)$也是横跨切割，那么做新的最小生成树$T'$其中在原最小生成树$T$的基础上删除$(x,y)$并且添加$(u,v)$使得图继续保持联通，这时我们有：
$$
w(T')=w(T)-w(x,y)+w(u,v)\le w(T)
$$
但同时$T$也是最小生成树所以有$w(T)\le w(T')$所以综上所述，$T'$也是最小生成树；

> 这里的描述遵循书中证明，推测原因是采用反证法，如果不含当前的轻量级边那么经过删除添加边的操作使其成为含轻量级边的最小生成树，那么符合最终要求的合理可能是轻量级边有多个。

因为$A\bigcup {(u,v)}$同样是最小生成树的子集所以满足条件，所以安全边的性质被满足。

更泛泛的说寻找最小生成树作为上述定理的动态过程，明显能推出整个过程为：

- 寻找一个顶点加入$A$；
- 做尊重$A$的切割，且切割后含$A$集合的一端不包含其他边集合；
- 在上述条件的横跨切割中寻找轻量级边；
- 加入轻量级边并将其拉至$A$集合的切割一端直到$|A|=|V|-1$；

另一种描述是：

在单独顶点作为树的大小为$V$的森林中，寻找最小的安全的边连接森林中不同的连通分量直到森林全联通。